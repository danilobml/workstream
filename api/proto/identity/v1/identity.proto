syntax = "proto3";

option go_package = "github.com/danilobml/workstream/internal/gen/identity/v1";

service IdentityService {
    rpc Register(RegisterRequest) returns (RegisterResponse);
	rpc Login(LoginRequest) returns (LoginResponse);
	rpc Unregister(UnregisterRequest) returns (UnregisterResponse);
	rpc RequestPasswordReset(RequestPasswordResetRequest) returns (RequestPasswordResetResponse);
	rpc ResetPassword(ResetPasswordRequest) returns (ResetPasswordResponse);
	// admin
	rpc ListAllUsers(ListAllUsersRequest) returns (UserListResponse);
	rpc RemoveUser(RemoveUserRequest) returns (RemoveUserResponse);
	// TODO - Implement the RPCs below as needed:
	/* rpc GetUserData(GetUserDataRequest) returns (SingleUserResponse);
	rpc UpdateUserData(UpdateUserRequest) returns (UpdateUserResponse);
	rpc GetUser(GetUserRequest) returns (SingleUserResponse);
	rpc CheckUser(CheckUserRequest) returns (CheckUserResponse); */
};

message RegisterRequest {
    string email = 1;
    string password = 2;
    repeated string roles = 3;
};

message RegisterResponse {
    string token = 1;
};

message LoginRequest {
    string email = 1;
    string password = 2;
};

message LoginResponse {
    string token = 1;
};

message UnregisterRequest {
	string id = 1;
};

message UnregisterResponse {};

message RemoveUserRequest {
	string id = 1;
};

message RemoveUserResponse {};

message RequestPasswordResetRequest {
	string email = 1;
};

message RequestPasswordResetResponse {};

message ResetPasswordRequest {
	string password = 1;
	string reset_token = 2;
};

message ResetPasswordResponse {};

message Role {
	string name = 1;
};

message User {
	string id = 1;
	string email = 2;
	repeated Role roles = 3;
	bool is_active = 4;
};

message ListAllUsersRequest {};

message UserListResponse {
	repeated User users = 1;
};